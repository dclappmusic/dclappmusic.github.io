{"version":3,"sources":["webpack:///./src/views/Clapp.vue?5ee6","webpack:///./node_modules/core-js/modules/es.array.find.js","webpack:///./src/views/Clapp.vue?89ff","webpack:///src/views/Clapp.vue","webpack:///./src/views/Clapp.vue?8bbf","webpack:///./src/views/Clapp.vue?9036"],"names":["$","$find","find","addToUnscopables","arrayMethodUsesToLength","FIND","SKIPS_HOLES","USES_TO_LENGTH","Array","target","proto","forced","callbackfn","this","arguments","length","undefined","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","findLocation","on","geolocationError","$event","$router","go","_v","_s","clapps","directives","name","rawName","value","expression","arg","clapp_animacion","clapp_step","params","from","sub_page","id","band_closest","image","showFar_closest","band","_e","staticRenderFns","component"],"mappings":"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","file":"js/chunk-48069112.5989e8ae.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Clapp.vue?vue&type=style&index=0&id=0f916ac4&scoped=true&lang=scss&\"","'use strict';\nvar $ = require('../internals/export');\nvar $find = require('../internals/array-iteration').find;\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar FIND = 'find';\nvar SKIPS_HOLES = true;\n\nvar USES_TO_LENGTH = arrayMethodUsesToLength(FIND);\n\n// Shouldn't skip holes\nif (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.find` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.find\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES || !USES_TO_LENGTH }, {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND);\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page clapp\"},[_c('get-geolocation',{attrs:{\"findLocation\":_vm.findLocation},on:{\"geolocationError\":_vm.geolocationError}}),_c('svg',{staticClass:\"back\",attrs:{\"width\":\"26\",\"height\":\"24\",\"viewBox\":\"0 0 26 24\",\"fill\":\"none\",\"xmlns\":\"http://www.w3.org/2000/svg\"},on:{\"click\":function($event){return _vm.$router.go(-1)}}},[_c('path',{attrs:{\"d\":\"M0.939341 10.9393C0.353554 11.5251 0.353554 12.4749 0.939341 13.0607L10.4853 22.6066C11.0711 23.1924 12.0208 23.1924 12.6066 22.6066C13.1924 22.0208 13.1924 21.0711 12.6066 20.4853L4.12132 12L12.6066 3.51472C13.1924 2.92893 13.1924 1.97919 12.6066 1.3934C12.0208 0.807611 11.0711 0.807611 10.4853 1.3934L0.939341 10.9393ZM26 10.5L2 10.5V13.5L26 13.5V10.5Z\",\"fill\":\"white\"}})]),(_vm.show_founded)?_c('div',{staticClass:\"band close\"},[_c('p',{staticClass:\"parrafo clapps\"},[_vm._v(_vm._s(_vm.clapps))]),_c('p',{directives:[{name:\"touch\",rawName:\"v-touch:start\",value:(_vm.startHandler),expression:\"startHandler\",arg:\"start\"},{name:\"touch\",rawName:\"v-touch:end\",value:(_vm.endHandler),expression:\"endHandler\",arg:\"end\"},{name:\"touch\",rawName:\"v-touch\",value:(_vm.touchHandler),expression:\"touchHandler\"},{name:\"touch\",rawName:\"v-touch:longtap\",value:(_vm.longtapHandler),expression:\"longtapHandler\",arg:\"longtap\"}],staticClass:\"titulo tap\"},[_vm._v(\" \"+_vm._s(_vm.clapp_animacion[_vm.clapp_step])+\" \")]),_c('router-link',{attrs:{\"to\":{ name: \"sub\", params: {from: \"clapp\", sub_page: \"sub_profile_band\", id: _vm.band_closest.id }}}},[_c('p',{staticClass:\"titulo name\"},[_vm._v(\" \"+_vm._s(_vm.band_closest.name)+\" \")])]),_c('div',{staticClass:\"background\"},[_c('span',{staticClass:\"overlay\"}),_c('img',{staticClass:\"image_band\",attrs:{\"src\":_vm.band_closest.image}})])],1):(_vm.showFar_closest)?_c('div',{staticClass:\"band far\"},[_c('p',{staticClass:\"titulo tap\"},[_vm._v(\" no shows cerca. el más cercano es \")]),_c('p',{staticClass:\"titulo name\"},[_vm._v(\" \"+_vm._s(_vm.showFar_closest.band)+\" \")])]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"page clapp\">\n        <get-geolocation @geolocationError=\"geolocationError\" :findLocation=\"findLocation\"/>\n        <svg @click=\"$router.go(-1)\" class=\"back\" width=\"26\" height=\"24\" viewBox=\"0 0 26 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path d=\"M0.939341 10.9393C0.353554 11.5251 0.353554 12.4749 0.939341 13.0607L10.4853 22.6066C11.0711 23.1924 12.0208 23.1924 12.6066 22.6066C13.1924 22.0208 13.1924 21.0711 12.6066 20.4853L4.12132 12L12.6066 3.51472C13.1924 2.92893 13.1924 1.97919 12.6066 1.3934C12.0208 0.807611 11.0711 0.807611 10.4853 1.3934L0.939341 10.9393ZM26 10.5L2 10.5V13.5L26 13.5V10.5Z\" fill=\"white\"/>\n        </svg>\n\n        <div v-if=\"show_founded\" class=\"band close\">\n            <p class=\"parrafo clapps\">{{clapps}}</p>\n            <!-- <p class=\"titulo animation\">\n                {{clapp_animacion[clapp_step]}}\n            </p> -->\n            <p class=\"titulo tap\" \n                v-touch:start=\"startHandler\" \n                v-touch:end=\"endHandler\"\n                v-touch=\"touchHandler\"\n                v-touch:longtap=\"longtapHandler\"\n            >\n               {{clapp_animacion[clapp_step]}}\n            </p>\n            <router-link :to='{ name: \"sub\", params: {from: \"clapp\", sub_page: \"sub_profile_band\", id: band_closest.id }}'>\n                <p class=\"titulo name\">\n                    {{band_closest.name}}\n                </p>\n            </router-link>\n            <div class=\"background\">\n                <span class=\"overlay\"></span>\n                <img class=\"image_band\" :src=\"band_closest.image\" />\n            </div>\n        </div>\n        <div v-else-if=\"showFar_closest\" class=\"band far\">\n            <p class=\"titulo tap\">\n                no shows cerca.\n                el más cercano es \n            </p>\n            <p class=\"titulo name\">\n                {{showFar_closest.band}}\n            </p>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nimport firebase from \"firebase\"\nimport GetGeolocation from '@/components/GetGeolocation'\nexport default {\n\tname: 'Clapp',\n    components: {\n        GetGeolocation\n    },\n    computed: {\n        ...mapState([\n            \"geolocation\", \"shows\", \"bands\"\n        ]),\n    },\n\tdata() {\n\t\treturn{\n            user_id: 11111,\n            distance_max: 0.013,\n            distance: null,\n            show_closest: null,\n            band_closest: null,\n            shows_close: [],\n            shows_far: [],\n            showFar_closest: null,\n            show_founded: false,\n            shows_active: [],\n            clapp_time: 0,\n            clapp_taps: 0,\n            clapp_start: null,\n            clapps: 0,\n            clapp_animacion: [\n                \"tap to clapp\", \"beh\", \"guay\", \"la ostia\", \"wooooooooow\"\n            ],\n            clapp_step: 0,\n            clapp_step_init: 0,\n            interval: null,\n            upload_timer: null,\n            findLocation: false\n        }\n\t},\n    watch: {\n        clapp_time() {\n            console.log(this.clapp_time);\n            const clapp_value =  Math.round(this.clapp_time/100);\n            clapp_value < 1 ? this.clapp_taps++ : this.clapps += clapp_value;\n        },\n        clapp_taps() {\n            this.clapps++;\n        },\n        geolocation() {\n            this.filter_shows_today();\n            this.arrangeShows();\n        },\n        clapps() {\n            if (this.clapps > 10) {\n                if (this.clapps > 20) {\n                    this.clapp_step_init = 2;\n                } else {\n                    this.clapp_step_init = 1;\n                }\n            } else {this.clapp_step_init = 0;}\n        },\n        shows() {\n            this.filter_shows_today();\n            this.arrangeShows();\n        }\n    },\n\tcreated() {\n        if (this.geolocation && this.shows) {\n            this.filter_shows_today();\n            this.arrangeShows();\n        } else {\n            // let waiting = setInterval(() => {\n            //     this.clapp_step < 3 ? this.clapp_step++ : '';\n            // }, 1000);\n        }\n    },\n\tmounted() {\n    },\n\tmethods: {\n        filter_shows_today: function() {\n            console.log('filtering');\n            const hoy = this.$moment();\n            this.shows.forEach(show => {\n                const show_time = this.$moment(show.timestamp);\n                const diff = show_time.diff(hoy, 'hours');\n                if (diff > -1 && diff < 1 ) {\n                    this.shows_active.push(show);\n                }\n            });\n        },\n        arrangeShows() {\n            console.log('arranging shows');\n            this.shows_active.forEach((Ishow_activo) => {\n                Ishow_activo.position = {lat: Ishow_activo.lat, lon: Ishow_activo.lon};\n                if (this.isCerca(Ishow_activo.position, this.geolocation)) {\n                    this.show_founded = true;\n                    Ishow_activo.distance = this.distance;\n                    this.shows_close.push(Ishow_activo);\n                } else {\n                    Ishow_activo.distance = this.distance;\n                    this.shows_far.push(Ishow_activo);\n                }\n            });\n            this.shows_close.sort((a, b) => a.distance - b.distance);\n            this.shows_far.sort((a, b) => a.distance - b.distance);\n\n            this.show_closest = this.shows_close[0];\n            this.showFar_closest = this.shows_far[0];\n\n            if (this.show_closest) {\n                this.band_closest = this.getBand(this.show_closest.band_id);\n            }\n        },\n        isCerca: function(posicion1, posicion2) {\n            this.distance = Math.pow((Math.pow(posicion1.lat - posicion2.lat, 2) + Math.pow(posicion1.lon - posicion2.lon,2)), 0.5);\n            return this.distance <= this.distance_max;\n        },\n        getBand(band_id) {\n            console.log('get band');\n            return this.bands.find(band => band.id === band_id);\n        },\n        // clapp() {\n        //     this.clapps++;\n        // },\n        touchHandler(e) {\n            // const touch = this.$moment(e.timeStamp).millisecond();\n            console.log(e + 'touch');\n            // this.clapps += 1;\n        },\n        startHandler(e) {\n            clearInterval(this.upload_timer);\n            this.clapp_step = this.clapp_step_init;\n            this.interval = setInterval(() => {\n                this.clapp_step < 3 ? this.clapp_step++ : '';\n            }, 500);\n\n            const empieza = this.$moment(e.timeStamp).millisecond();\n            console.log('start: ' + empieza);\n            this.clapp_start = empieza;\n            \n        },\n        endHandler(e) {\n            clearInterval(this.interval);\n            setTimeout(() => {this.clapp_step = 0;}, 1000);\n\n            const termina = this.$moment(e.timeStamp);\n            console.log('end:' + termina.millisecond());\n            this.clapp_time = termina.subtract(this.clapp_start, 'milliseconds').millisecond();\n\n            this.upload_timer = setTimeout(() => {\n                this.uploadClapps();\n            }, 3000);\n        },\n        longtapHandler(e) {\n            console.log(e);\n        },\n        uploadClapps() {\n            let doc_name = this.user_id + '-' + this.show_closest.band_id + '-' + this.clapps;\n            let clapp_ob = {\n                band_id: this.band_closest.id,\n                show_id: this.show_closest.show_id,\n                user_id: this.user_id,\n                clapp_time: this.clapp_time,\n                clapp_taps: this.clapp_taps,\n                timestamp: new Date()\n            }\n            firebase.firestore().collection(\"clapps\").doc(doc_name).set(clapp_ob).then(() => {\n                console.log(\"clapp uploaded\");\n                this.postclapp('band_profile')\n            })\n        },\n        postclapp(type) {\n            if (type === 'band_profile') {\n                this.$router.push({ name: \"sub\", params: {from: \"postclapp\", sub_page: \"sub_profile_band\", id: this.band_closest.id }});\n            }\n        },\n        geolocationError(error) {\n            alert(error);\n        }\n    }\n}\n</script>\n<style scoped lang=\"scss\">\n.clapp {\n    position: relative;\n    width: 100vw;\n    height: 100vh;\n    background: var(--color_primario);\n    z-index: -1;\n    // background-blend-mode: screen;\n    .band {\n        width: 100%;\n        height: 100%;\n        .animation {\n            position: absolute;\n            top: 20vh;\n            width: 100%;\n            font-size: 15vw;\n            text-align: center;\n            color: var(--color_secundario);\n            transition: all .5s ease-in-out;\n        }\n        .clapps {\n            position: absolute;\n            top: 20px;\n            right: 20px;\n            color: var(--color_secundario);\n        }\n        .name {\n            position: absolute;\n            width: 100%;\n            bottom: 20vh;\n            font-size: 15vw;\n            color: var(--color_secundario);\n            text-align: center;\n            line-height: 85%;\n        }\n        .tap {\n            position: absolute;\n            top: 40vh;\n            width: 100%;\n            color: white;\n            font-weight: 500;\n            font-size: 35px;\n            line-height: 26px;\n            text-align: center;\n        }\n        .background {\n            position: absolute;\n            width: 100%;\n            height: 100%;\n            z-index: -1;\n            .image_band {\n                width: 100%;\n                height: 100%;\n                object-fit: cover;\n            } \n            .overlay {\n                position: absolute;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                background: var(--color_primario);\n                mix-blend-mode: screen;\n            }\n        }\n    }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Clapp.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Clapp.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Clapp.vue?vue&type=template&id=0f916ac4&scoped=true&\"\nimport script from \"./Clapp.vue?vue&type=script&lang=js&\"\nexport * from \"./Clapp.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Clapp.vue?vue&type=style&index=0&id=0f916ac4&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0f916ac4\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}