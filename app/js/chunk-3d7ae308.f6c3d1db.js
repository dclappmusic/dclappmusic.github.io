(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3d7ae308"],{"11ec":function(t,s,a){},"36b0":function(t,s,a){"use strict";a("11ec")},"7db0":function(t,s,a){"use strict";var o=a("23e7"),n=a("b727").find,i=a("44d2"),e=a("ae40"),c="find",l=!0,p=e(c);c in[]&&Array(1)[c]((function(){l=!1})),o({target:"Array",proto:!0,forced:l||!p},{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),i(c)},b941:function(t,s,a){"use strict";a.r(s);var o=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"page clapp"},[a("get-geolocation",{attrs:{findLocation:t.findLocation},on:{geolocationError:t.geolocationError}}),a("svg",{staticClass:"back",attrs:{width:"26",height:"24",viewBox:"0 0 26 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},on:{click:function(s){return t.$router.go(-1)}}},[a("path",{attrs:{d:"M0.939341 10.9393C0.353554 11.5251 0.353554 12.4749 0.939341 13.0607L10.4853 22.6066C11.0711 23.1924 12.0208 23.1924 12.6066 22.6066C13.1924 22.0208 13.1924 21.0711 12.6066 20.4853L4.12132 12L12.6066 3.51472C13.1924 2.92893 13.1924 1.97919 12.6066 1.3934C12.0208 0.807611 11.0711 0.807611 10.4853 1.3934L0.939341 10.9393ZM26 10.5L2 10.5V13.5L26 13.5V10.5Z",fill:"white"}})]),t.show_founded?a("div",{staticClass:"band close"},[a("p",{staticClass:"parrafo clapps"},[t._v(t._s(t.clapps))]),a("p",{directives:[{name:"touch",rawName:"v-touch:start",value:t.startHandler,expression:"startHandler",arg:"start"},{name:"touch",rawName:"v-touch:end",value:t.endHandler,expression:"endHandler",arg:"end"},{name:"touch",rawName:"v-touch",value:t.touchHandler,expression:"touchHandler"},{name:"touch",rawName:"v-touch:longtap",value:t.longtapHandler,expression:"longtapHandler",arg:"longtap"}],staticClass:"titulo tap"},[t._v(" "+t._s(t.clapp_animacion[t.clapp_step])+" ")]),a("router-link",{attrs:{to:{name:"sub",params:{from:"clapp",sub_page:"sub_profile_band",id:t.band_closest.id}}}},[a("p",{staticClass:"titulo name"},[t._v(" "+t._s(t.band_closest.name)+" ")])]),a("div",{staticClass:"background"},[a("span",{staticClass:"overlay"}),a("img",{staticClass:"image_band",attrs:{src:t.band_closest.image}})])],1):t.showFar_closest?a("div",{staticClass:"band far"},[a("p",{staticClass:"titulo tap"},[t._v(" no shows cerca. el m√°s cercano es ")]),a("p",{staticClass:"titulo name"},[t._v(" "+t._s(t.showFar_closest.band)+" ")])]):t._e()],1)},n=[],i=(a("7db0"),a("4160"),a("159b"),a("5530")),e=a("2f62"),c=a("8aa5"),l=a.n(c),p=a("6422"),r={name:"Clapp",components:{GetGeolocation:p["a"]},computed:Object(i["a"])({},Object(e["b"])(["geolocation","shows","bands"])),data:function(){return{user_id:11111,distance_max:.013,distance:null,show_closest:null,band_closest:null,shows_close:[],shows_far:[],showFar_closest:null,show_founded:!1,shows_active:[],clapp_time:0,clapp_taps:0,clapp_start:null,clapps:0,clapp_animacion:["tap to clapp","beh","guay","la ostia","wooooooooow"],clapp_step:0,clapp_step_init:0,interval:null,upload_timer:null,findLocation:!1}},watch:{clapp_time:function(){console.log(this.clapp_time);var t=Math.round(this.clapp_time/100);t<1?this.clapp_taps++:this.clapps+=t},clapp_taps:function(){this.clapps++},geolocation:function(){this.filter_shows_today(),this.arrangeShows()},clapps:function(){this.clapps>10?this.clapps>20?this.clapp_step_init=2:this.clapp_step_init=1:this.clapp_step_init=0},shows:function(){this.filter_shows_today(),this.arrangeShows()}},created:function(){this.geolocation&&this.shows&&(this.filter_shows_today(),this.arrangeShows())},mounted:function(){},methods:{filter_shows_today:function(){var t=this;console.log("filtering");var s=this.$moment();this.shows.forEach((function(a){var o=t.$moment(a.timestamp),n=o.diff(s,"hours");n>-1&&n<1&&t.shows_active.push(a)}))},arrangeShows:function(){var t=this;console.log("arranging shows"),this.shows_active.forEach((function(s){s.position={lat:s.lat,lon:s.lon},t.isCerca(s.position,t.geolocation)?(t.show_founded=!0,s.distance=t.distance,t.shows_close.push(s)):(s.distance=t.distance,t.shows_far.push(s))})),this.shows_close.sort((function(t,s){return t.distance-s.distance})),this.shows_far.sort((function(t,s){return t.distance-s.distance})),this.show_closest=this.shows_close[0],this.showFar_closest=this.shows_far[0],this.show_closest&&(this.band_closest=this.getBand(this.show_closest.band_id))},isCerca:function(t,s){return this.distance=Math.pow(Math.pow(t.lat-s.lat,2)+Math.pow(t.lon-s.lon,2),.5),this.distance<=this.distance_max},getBand:function(t){return console.log("get band"),this.bands.find((function(s){return s.id===t}))},touchHandler:function(t){console.log(t+"touch")},startHandler:function(t){var s=this;clearInterval(this.upload_timer),this.clapp_step=this.clapp_step_init,this.interval=setInterval((function(){s.clapp_step<3&&s.clapp_step++}),500);var a=this.$moment(t.timeStamp).millisecond();console.log("start: "+a),this.clapp_start=a},endHandler:function(t){var s=this;clearInterval(this.interval),setTimeout((function(){s.clapp_step=0}),1e3);var a=this.$moment(t.timeStamp);console.log("end:"+a.millisecond()),this.clapp_time=a.subtract(this.clapp_start,"milliseconds").millisecond(),this.upload_timer=setTimeout((function(){s.uploadClapps()}),3e3)},longtapHandler:function(t){console.log(t)},uploadClapps:function(){var t=this,s=this.user_id+"-"+this.show_closest.band_id+"-"+this.clapps,a={band_id:this.band_closest.id,show_id:this.show_closest.show_id,user_id:this.user_id,clapp_time:this.clapp_time,clapp_taps:this.clapp_taps,timestamp:new Date};l.a.firestore().collection("clapps").doc(s).set(a).then((function(){console.log("clapp uploaded"),t.postclapp("band_profile")}))},postclapp:function(t){"band_profile"===t&&this.$router.push({name:"sub",params:{from:"postclapp",sub_page:"sub_profile_band",id:this.band_closest.id}})},geolocationError:function(t){alert(t)}}},h=r,d=(a("36b0"),a("2877")),u=Object(d["a"])(h,o,n,!1,null,"73752655",null);s["default"]=u.exports}}]);
//# sourceMappingURL=chunk-3d7ae308.f6c3d1db.js.map