{"remainingRequest":"/Users/robertomesejosalas/websites/dclappmusic.github.io/prototipo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/robertomesejosalas/websites/dclappmusic.github.io/prototipo/src/App.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/robertomesejosalas/websites/dclappmusic.github.io/prototipo/src/App.vue","mtime":1574528894000},{"path":"/Users/robertomesejosalas/websites/dclappmusic.github.io/prototipo/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/robertomesejosalas/websites/dclappmusic.github.io/prototipo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/robertomesejosalas/websites/dclappmusic.github.io/prototipo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\timport firebase from \"firebase\";\n\timport Nav from '@/components/Nav';\n\timport Header from '@/components/Header';\n\timport PopupInstall from '@/components/PopupInstall';\n    import PopupLogin from '@/components/PopupLogin';\n\n\texport default {\n\t\tname: 'app',\n\t\tcomponents: {\n\t\t\tNav,\n\t\t\tHeader,\n\t\t\tPopupInstall,\n            PopupLogin\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n                show_login: true,\n                usuario: {},\n                geolocation: {\n                    latitud: null,\n                    longitud: null\n                },\n                shows: [],\n                show_install: false,\n                deferredPrompt: null\n\t\t\t}\n\t\t},\n\t\tcreated() {\n            setInterval(() => {\n                this.fecha_hoy = new Date();\n            }, 1000);\n\n\t\t\tfirebase.auth().onAuthStateChanged(user => {\n\t\t\t\tif (user) {\n\t\t\t\t\tconsole.log(\"ya estas logueado\");\n\t\t\t\t\tconsole.log(user);\n\t\t\t\t\tthis.show_login = false;\n//descargarse usuario\n\t\t\t\t\tfirebase.firestore().collection(\"fans\").doc(user.uid).onSnapshot((doc) => {\n                        this.usuario = doc.data();\n                        console.log(this.usuario);\n\t\t\t\t\t});\n\t\t\t\t\t// this.$router.replace('fichaje');\n\t\t\t\t} else {\n\t\t\t\t\t// No user is signed in.\n                    this.show_login = true;\n\t\t\t\t\tconsole.log(\"no estás logueado\");\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tmounted() {\n            this.get_shows();\n\t\t\t// alert(\"mounted\");\n\t\t\twindow.addEventListener('beforeinstallprompt', (e) => {\n\t\t\t\t// Prevent Chrome 67 and earlier from automatically showing the prompt\n\t\t\t\te.preventDefault();\n\t\t\t\t// alert(\"before install\");\n\t\t\t\t// Stash the event so it can be triggered later.\n\t\t\t\tthis.deferredPrompt = e;\n\t\t\t\t\n\t\t\t\t// Update UI notify the user they can add to home screen\n\t\t\t\tthis.show_install = true;\n\t\t\t});\n\t\t},\n\t\tmethods: {\n            get_shows: function() {\n                if (localStorage.getItem('coords')){\n                    this.geolocation = JSON.parse(localStorage.getItem('coords'));\n                    console.log(this.geolocation);\n                }\n                this.get_geolocation();\n                var db = firebase.firestore();\n                db.collection(\"shows\").onSnapshot((querySnapshot) => {\n                    querySnapshot.forEach((doc) => {\n                        var shows = doc.data();\n                        console.log(shows);\n                        this.shows.push(shows);\n                    });\n                });\n            },\n\t\t\tget_geolocation: function() {\n                if (navigator.geolocation) {\n                    navigator.geolocation.getCurrentPosition(\n                        this.browserGeolocationSuccess,\n                        this.browserGeolocationFail,\n                        {maximumAge: 20000, timeout: 10000, enableHighAccuracy: false}\n                    );\n                } else {\n                    console.log(\"Navigator geolocation unavailable.\");\n                    // $(\".act .name\").html(\"No se puede acceder a la ubicación en tu móvil :'(\").addClass(\"error\");\n                }\n            },\n            browserGeolocationSuccess: function(position) {\n                this.geolocation.latitud = position.coords.latitude;\n                this.geolocation.longitud = position.coords.longitude;\n                console.log(\"Browser geolocation success!\\n\\nlat = \" + position.coords.latitude + \"\\nlng = \" + position.coords.longitude);\n                localStorage.setItem('coords', JSON.stringify(this.geolocation));\n            },\n            browserGeolocationFail: function(error) {\n                switch (error.code) {\n                    case error.TIMEOUT:\n                        console.log(\"Browser geolocation error !\\n\\nTimeout.\");\n                        // $(\".act .name\").html(\"Hay problemas con el acceso a tu ubicación\");\n                    break;\n                    case error.PERMISSION_DENIED:\n                        if(error.message.indexOf(\"Only secure origins are allowed\") == 0) {\n                            this.tryAPIGeolocation();\n                        } else {\n                            console.log(\"Permison denied\");\n                            // $(\".act .name\").html(\"No nos has dado permiso de acceder a tu ubicación\");\n                            // $(\".intro_clapp h3\").html(\"No nos has dado permiso de acceder a tu ubicación\");\n                        }\n                    break;\n                    case error.POSITION_UNAVAILABLE:\n                        console.log(\"Browser geolocation error !\\n\\nPosition unavailable.\");\n                        // $(\".act .name\").html(\"Browser geolocation error !\\n\\nPosition unavailable\");\n                    break;\n                }\n            },\n            tryAPIGeolocation: function() {\n                jQuery.post( \"https://www.googleapis.com/geolocation/v1/geolocate?key=AIzaSyDCa1LUe1vOczX1hO_iGYgyo8p_jYuGOPU\", function(success) {\n                    this.apiGeolocationSuccess({coords: {latitude: success.location.lat, longitude: success.location.lng}});\n                })\n                .fail(function(err) {\n                    console.log(\"API Geolocation error! \\n\\n\"+err);\n                    // $(\".act .name\").html(\"API Geolocation error! \\n\\n\"+err);\n                });\n            },\n\n            apiGeolocationSuccess: function(position) {\n                this.geolocation.latitud = position.coords.latitude;\n                this.geolocation.longitud = position.coords.longitude;\n                console.log(\"API geolocation success!\\n\\nlat = \" + latitud + \"\\nlng = \" + longitud);\n                localStorage.setItem('coords', JSON.stringify(this.geolocation));\n            }\n\t\t}\n\t};\n",{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAiBA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n\t<div id=\"app\" class=\"container\">\n\t\t<!-- <Header :usuario=\"this.usuario\" /> -->\n\t\t<router-view\n            :geolocation=\"this.geolocation\"\n            :shows=\"this.shows\"\n\t\t/>\n        <PopupLogin v-if=\"show_login\" />\n\t\t<PopupInstall \n\t\t\tv-if=\"show_install\" \n\t\t\t:deferredPrompt=\"this.deferredPrompt\" \n\t\t\t@cerrar_popup=\"event_cerrar_popup\"\n\t\t/>\n\t</div>\n</template>\n\n<script>\n\timport firebase from \"firebase\";\n\timport Nav from '@/components/Nav';\n\timport Header from '@/components/Header';\n\timport PopupInstall from '@/components/PopupInstall';\n    import PopupLogin from '@/components/PopupLogin';\n\n\texport default {\n\t\tname: 'app',\n\t\tcomponents: {\n\t\t\tNav,\n\t\t\tHeader,\n\t\t\tPopupInstall,\n            PopupLogin\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n                show_login: true,\n                usuario: {},\n                geolocation: {\n                    latitud: null,\n                    longitud: null\n                },\n                shows: [],\n                show_install: false,\n                deferredPrompt: null\n\t\t\t}\n\t\t},\n\t\tcreated() {\n            setInterval(() => {\n                this.fecha_hoy = new Date();\n            }, 1000);\n\n\t\t\tfirebase.auth().onAuthStateChanged(user => {\n\t\t\t\tif (user) {\n\t\t\t\t\tconsole.log(\"ya estas logueado\");\n\t\t\t\t\tconsole.log(user);\n\t\t\t\t\tthis.show_login = false;\n//descargarse usuario\n\t\t\t\t\tfirebase.firestore().collection(\"fans\").doc(user.uid).onSnapshot((doc) => {\n                        this.usuario = doc.data();\n                        console.log(this.usuario);\n\t\t\t\t\t});\n\t\t\t\t\t// this.$router.replace('fichaje');\n\t\t\t\t} else {\n\t\t\t\t\t// No user is signed in.\n                    this.show_login = true;\n\t\t\t\t\tconsole.log(\"no estás logueado\");\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tmounted() {\n            this.get_shows();\n\t\t\t// alert(\"mounted\");\n\t\t\twindow.addEventListener('beforeinstallprompt', (e) => {\n\t\t\t\t// Prevent Chrome 67 and earlier from automatically showing the prompt\n\t\t\t\te.preventDefault();\n\t\t\t\t// alert(\"before install\");\n\t\t\t\t// Stash the event so it can be triggered later.\n\t\t\t\tthis.deferredPrompt = e;\n\t\t\t\t\n\t\t\t\t// Update UI notify the user they can add to home screen\n\t\t\t\tthis.show_install = true;\n\t\t\t});\n\t\t},\n\t\tmethods: {\n            get_shows: function() {\n                if (localStorage.getItem('coords')){\n                    this.geolocation = JSON.parse(localStorage.getItem('coords'));\n                    console.log(this.geolocation);\n                }\n                this.get_geolocation();\n                var db = firebase.firestore();\n                db.collection(\"shows\").onSnapshot((querySnapshot) => {\n                    querySnapshot.forEach((doc) => {\n                        var shows = doc.data();\n                        console.log(shows);\n                        this.shows.push(shows);\n                    });\n                });\n            },\n\t\t\tget_geolocation: function() {\n                if (navigator.geolocation) {\n                    navigator.geolocation.getCurrentPosition(\n                        this.browserGeolocationSuccess,\n                        this.browserGeolocationFail,\n                        {maximumAge: 20000, timeout: 10000, enableHighAccuracy: false}\n                    );\n                } else {\n                    console.log(\"Navigator geolocation unavailable.\");\n                    // $(\".act .name\").html(\"No se puede acceder a la ubicación en tu móvil :'(\").addClass(\"error\");\n                }\n            },\n            browserGeolocationSuccess: function(position) {\n                this.geolocation.latitud = position.coords.latitude;\n                this.geolocation.longitud = position.coords.longitude;\n                console.log(\"Browser geolocation success!\\n\\nlat = \" + position.coords.latitude + \"\\nlng = \" + position.coords.longitude);\n                localStorage.setItem('coords', JSON.stringify(this.geolocation));\n            },\n            browserGeolocationFail: function(error) {\n                switch (error.code) {\n                    case error.TIMEOUT:\n                        console.log(\"Browser geolocation error !\\n\\nTimeout.\");\n                        // $(\".act .name\").html(\"Hay problemas con el acceso a tu ubicación\");\n                    break;\n                    case error.PERMISSION_DENIED:\n                        if(error.message.indexOf(\"Only secure origins are allowed\") == 0) {\n                            this.tryAPIGeolocation();\n                        } else {\n                            console.log(\"Permison denied\");\n                            // $(\".act .name\").html(\"No nos has dado permiso de acceder a tu ubicación\");\n                            // $(\".intro_clapp h3\").html(\"No nos has dado permiso de acceder a tu ubicación\");\n                        }\n                    break;\n                    case error.POSITION_UNAVAILABLE:\n                        console.log(\"Browser geolocation error !\\n\\nPosition unavailable.\");\n                        // $(\".act .name\").html(\"Browser geolocation error !\\n\\nPosition unavailable\");\n                    break;\n                }\n            },\n            tryAPIGeolocation: function() {\n                jQuery.post( \"https://www.googleapis.com/geolocation/v1/geolocate?key=AIzaSyDCa1LUe1vOczX1hO_iGYgyo8p_jYuGOPU\", function(success) {\n                    this.apiGeolocationSuccess({coords: {latitude: success.location.lat, longitude: success.location.lng}});\n                })\n                .fail(function(err) {\n                    console.log(\"API Geolocation error! \\n\\n\"+err);\n                    // $(\".act .name\").html(\"API Geolocation error! \\n\\n\"+err);\n                });\n            },\n\n            apiGeolocationSuccess: function(position) {\n                this.geolocation.latitud = position.coords.latitude;\n                this.geolocation.longitud = position.coords.longitude;\n                console.log(\"API geolocation success!\\n\\nlat = \" + latitud + \"\\nlng = \" + longitud);\n                localStorage.setItem('coords', JSON.stringify(this.geolocation));\n            }\n\t\t}\n\t};\n</script>"]}]}