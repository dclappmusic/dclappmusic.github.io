<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="description" content="dClapp">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<title>dClapp</title>
	<link rel="icon" type="image/jpg" href="images/favicon.png">
	<link rel="stylesheet" href="css/styles.css">
	<meta name="p:domain_verify" content="010c67b82d18bca303e35e8b40011654"/>

</head>

<body>
	<div class="container home">
		<ul class="cambio_modo"></ul>
		<a class="boton showtime" href="clapp.html">
			<img src="images/icon_clapp.png" />
		</a>
		<div class="intro_clapp">
		<a href="login.html">	<h3 class="display-med">para clappear<br>pulsa el botón</h3></a>
		</div>

		<ul class="menu">
			<li class="menu-tit">
				<a href="historial.html">historial</a>
			</li>
			<li class="menu-tit active" id="preclapp">
				<a href="index.html">CLAPP</a>
			</li>
			<li class="menu-tit">
				<a href="opciones.html">opciones</a>
			</li>
		</ul>
	</div>

	

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.5.1/firebase.js"></script>
<script type="text/javascript" src="js/firebase-config.js"></script>
<script type="text/javascript" src="js/script.js"></script>
<script type="text/javascript">
	function funcion_user () {
		var user;

		//cargar el usuario de la DB
		const userRef = firestore.collection("usuarios").doc(userId);
		const bandsRef = firestore.collection("bandas");
		var bandRef;
		userRef.get().then((doc) => {
			if (doc.exists) {
				console.log("Document data:", doc.data());
				user = doc.data();
				console.log("bandas del user: " + user.band);

				//si tiene bandas, añadir al menu
				if (user.band.length > 0) {
					console.log(user.band);
					user.band.forEach((banda) => {
						const bandRef = bandsRef.doc(banda);
						bandRef.get().then((doc) => {
							const db_banda = doc.data();
							console.log(db_banda);
							const liBandas = "<li><a href='showtime.html?user=" + userId + "&band=" + banda + "'>" + db_banda.nombre + "</a></li>"
							$(".cambio_modo").append(liBandas);
						});
					});
				} else {
					console.log("no bands");
					$(".cambio_modo").hide();
				}
			} else {
				// doc.data() will be undefined in this case
				console.log("No such document!");
			}
		}).catch(function(error) {
			console.log("Error getting document:", error);
		});
	}
</script>
</body>
</html>








