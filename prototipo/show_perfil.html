<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="description" content="dClapp">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<title>dClapp</title>
	<link rel="icon" type="image/jpg" href="images/favicon.png">
	<link rel="stylesheet" href="css/styles.css">
	<meta name="p:domain_verify" content="010c67b82d18bca303e35e8b40011654"/>

</head>

<body>
	<div class="container show_perfil">
        <a class="cambio_modo" href="index.html">volver a clapp</a>
        <div class="act">
            <label class="imagen" for="band-image"></label>
            <input id="band-image" class="image-input" type="file" name="band-imagen" accept="image/png, image/jpeg" id="band-image">
            <!-- <div class="imagen"></div> -->
            <input id="band-name" class="titulo name" type="text" name="band-name" value="">
            <h2 class="titulo name"></h2>
            <ul class="tabs">
                <li class="menu-tit active" data-tab="stats">STATS</li>
                <li class="menu-tit" data-tab="info">INFO</li>
                <li class="menu-tit" data-tab="shows">SHOWS</li>
            </ul>
        </div>
        <div class="secciones">
            <div class="stats">
                <ul class="resumen">
                    <li class="ciudad">
                        <p>Madrid</p>
                    </li>
                    <li class="clapps">
                        <p>3k</p>
                    </li>
                    <li class="actuaciones">
                        <p>130</p>
                    </li>
                </ul>
            </div>
            <div class="info">
                <div class="descripcion">
                    <!-- <p class="parrafo">
                        Instrumental folk guitarist from France My first EP “Fragments of Soul“ .Check the news on Facebook, Youtube, Bandcamp and Soundcloud.
                        I'm also looking for a video-music project. If you produce films, short films, documentaries etc 
                    </p> -->
                    <textarea id="band-descripcion" class="titulo name" type="text" name="band-name" value=""></textarea>
                </div>
            </div>
            <div class="shows">
                shows
            </div>
        </div>
        <ul class="menu">
            <li class="menu-tit">
                <a href="#">historial</a>
            </li>
            <li class="menu-tit" id="preclapp">
                <a href="showtime.html">SHOW</a>
            </li>
            <li class="menu-tit active">
                <a href="show_perfil.html">perfil</a>
            </li>
        </ul>
	</div>

	

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.5.1/firebase.js"></script>
<script type="text/javascript" src="js/firebase-config.js"></script>
<script type="text/javascript" src="js/script.js"></script>
<script type="text/javascript">

    $(".tabs li").click(function(){
        var tab = $(this).data("tab");
        console.log(tab);
        $(this).addClass("active").siblings().removeClass("active");
        $(".secciones ." + tab).show().siblings().hide();
    });

    function funcion_user () {
		var bandId = getUrlParameter("band");
		
		$('a').each(function() {
			var href = $(this).attr('href');
			if (href && (href != "index.html")) {
				href += (href.match(/\?/) ? '&' : '?') + "band=" + bandId;
				$(this).attr('href', href);
			}
        });
        //encuentra la banda seguún el ID
        var banda;
        //traer banda de base de datos
		const bandRef = firestore.collection("bandas").doc(bandId);
		bandRef.get().then((doc) => {
			banda = doc.data();
            console.log("banda: " + banda.nombre);

        //diplay en pantalla de datos de la banda
            $("#band-name").attr("value", banda.nombre);
            $(".resumen .ciudad p").html(banda.ciudad);
            $(".resumen .clapps p").html(banda.num_clapps);
            $(".resumen .actuaciones p").html(banda.shows.length);
            if (banda.imagen) {
                $(".act .imagen").css("background-image", "url(" + banda.imagen + ")");
            } else {
                $(".act .imagen").css("background-image", "url(images/perfil_kurt.png)");
            }
            // $(".act .descripcion .parrafo").html(band.descripcion);
        });
        
        //si cambia el nombre, coger el nuevo y guardarlo en una variable
        var nombre;
        var imagen;
        $("#band-name").change(function() {
            nombre = document.querySelector("#band-name").value;
        });
        $("#band-image").change(function() {
            imagen = document.querySelector("#band-image").files[0];
        });

        //actualizar el perfil de la banda en la DB
        var actualizar_perfil = function(){
            bandRef.update({
                "nombre": nombre,
                descripcion: descripcion,
                imagen: imagenURL
            });
        }
	};    
</script>
</body>
</html>








