(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57d2a4b8"],{"0a49":function(o,t,e){var n=e("9b43"),s=e("626a"),a=e("4bf8"),i=e("9def"),c=e("cd1c");o.exports=function(o,t){var e=1==o,l=2==o,r=3==o,p=4==o,u=6==o,h=5==o||u,d=t||c;return function(t,c,g){for(var f,_,m=a(t),w=s(m),b=n(c,g,3),v=i(w.length),y=0,O=e?d(t,v):l?d(t,0):void 0;v>y;y++)if((h||y in w)&&(f=w[y],_=b(f,y,m),o))if(e)O[y]=_;else if(_)switch(o){case 3:return!0;case 5:return f;case 6:return y;case 2:O.push(f)}else if(p)return!1;return u?-1:r||p?p:O}}},7514:function(o,t,e){"use strict";var n=e("5ca1"),s=e("0a49")(5),a="find",i=!0;a in[]&&Array(1)[a]((function(){i=!1})),n(n.P+n.F*i,"Array",{find:function(o){return s(this,o,arguments.length>1?arguments[1]:void 0)}}),e("9c6c")(a)},b941:function(o,t,e){"use strict";e.r(t);var n=function(){var o=this,t=o.$createElement,e=o._self._c||t;return e("div",{staticClass:"page clapp"},[e("get-geolocation",{attrs:{findLocation:o.findLocation},on:{geolocationError:o.geolocationError}}),e("svg",{staticClass:"back",attrs:{width:"26",height:"24",viewBox:"0 0 26 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},on:{click:function(t){return o.$router.go(-1)}}},[e("path",{attrs:{d:"M0.939341 10.9393C0.353554 11.5251 0.353554 12.4749 0.939341 13.0607L10.4853 22.6066C11.0711 23.1924 12.0208 23.1924 12.6066 22.6066C13.1924 22.0208 13.1924 21.0711 12.6066 20.4853L4.12132 12L12.6066 3.51472C13.1924 2.92893 13.1924 1.97919 12.6066 1.3934C12.0208 0.807611 11.0711 0.807611 10.4853 1.3934L0.939341 10.9393ZM26 10.5L2 10.5V13.5L26 13.5V10.5Z",fill:"white"}})]),o.show_founded?e("div",{staticClass:"band close"},[e("p",{staticClass:"parrafo clapps"},[o._v(o._s(o.clapps))]),e("p",{directives:[{name:"touch",rawName:"v-touch:start",value:o.startHandler,expression:"startHandler",arg:"start"},{name:"touch",rawName:"v-touch:end",value:o.endHandler,expression:"endHandler",arg:"end"},{name:"touch",rawName:"v-touch",value:o.touchHandler,expression:"touchHandler"},{name:"touch",rawName:"v-touch:longtap",value:o.longtapHandler,expression:"longtapHandler",arg:"longtap"}],staticClass:"titulo tap"},[o._v("\n           "+o._s(o.clapp_animacion[o.clapp_step])+"\n        ")]),e("router-link",{attrs:{to:{name:"sub",params:{from:"clapp",sub_page:"sub_profile_band",id:o.band_closest.id}}}},[e("p",{staticClass:"titulo name"},[o._v("\n                "+o._s(o.band_closest.name)+"\n            ")])]),e("div",{staticClass:"background"},[e("span",{staticClass:"overlay"}),e("img",{staticClass:"image_band",attrs:{src:o.band_closest.image}})])],1):o.showFar_closest?e("div",{staticClass:"band far"},[e("p",{staticClass:"titulo tap"},[o._v("\n            no shows cerca.\n            el más cercano es \n        ")]),e("p",{staticClass:"titulo name"},[o._v("\n            "+o._s(o.showFar_closest.band)+"\n        ")])]):o._e()],1)},s=[],a=(e("8e6e"),e("456d"),e("7514"),e("55dd"),e("ac6a"),e("bd86")),i=e("2f62"),c=e("8aa5"),l=e.n(c),r=function(){var o=this,t=o.$createElement,e=o._self._c||t;return e("div")},p=[],u={name:"GetGeolocation",components:{},props:["findLocation"],data:function(){return{geolocation:{lat:null,lon:null}}},watch:{geolocation:function(){this.$store.commit("updateGeolocation",this.geolocation)},findLocation:function(){this.get_geolocation()}},created:function(){this.get_geolocation()},mounted:function(){},methods:{get_geolocation:function(){localStorage.getItem("coords")&&(this.geolocation=JSON.parse(localStorage.getItem("coords")),console.log(this.geolocation)),navigator.geolocation?navigator.geolocation.getCurrentPosition(this.browserGeolocationSuccess,this.browserGeolocationFail,{maximumAge:2e4,timeout:1e4,enableHighAccuracy:!1}):(console.log("Navigator geolocation unavailable."),this.$emit("geolocationError","No se puede acceder a la ubicación en tu móvil :'("))},browserGeolocationSuccess:function(o){this.geolocation.lat=o.coords.latitude,this.geolocation.lon=o.coords.longitude,console.log("Browser geolocation success!\n\nlat = "+o.coords.latitude+"\nlng = "+o.coords.longitude),localStorage.setItem("coords",JSON.stringify(this.geolocation)),this.$store.commit("updateGeolocation",this.geolocation)},browserGeolocationFail:function(o){switch(o.code){case o.TIMEOUT:console.log("Browser geolocation error !\n\nTimeout."),this.$emit("geolocationError","Hay problemas con el acceso a tu ubicación");break;case o.PERMISSION_DENIED:0==o.message.indexOf("Only secure origins are allowed")?this.tryAPIGeolocation():(console.log("Permison denied"),this.$emit("geolocationError","No nos has dado permiso de acceder a tu ubicación"));break;case o.POSITION_UNAVAILABLE:console.log("Browser geolocation error !\n\nPosition unavailable."),this.$emit("geolocationError","Browser geolocation error !\n\nPosition unavailable");break}},tryAPIGeolocation:function(){jQuery.post("https://www.googleapis.com/geolocation/v1/geolocate?key=AIzaSyDCa1LUe1vOczX1hO_iGYgyo8p_jYuGOPU",(function(o){this.apiGeolocationSuccess({coords:{latitude:o.location.lat,longitude:o.location.lng}})})).fail((function(o){console.log("API Geolocation error! \n\n"+o),this.$emit("geolocationError","API Geolocation error! \n\n"+o)}))},apiGeolocationSuccess:function(o){this.geolocation.lat=o.coords.latitude,this.geolocation.lon=o.coords.longitude,console.log("API geolocation success!\n\nlat = "+latitud+"\nlng = "+longitud),localStorage.setItem("coords",JSON.stringify(this.geolocation)),this.$store.commit("updateGeolocation",this.geolocation)}}},h=u,d=e("2877"),g=Object(d["a"])(h,r,p,!1,null,null,null),f=g.exports;function _(o,t){var e=Object.keys(o);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(o);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(o,t).enumerable}))),e.push.apply(e,n)}return e}function m(o){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?_(e,!0).forEach((function(t){Object(a["a"])(o,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(e)):_(e).forEach((function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(e,t))}))}return o}var w={name:"Clapp",components:{GetGeolocation:f},computed:m({},Object(i["b"])(["geolocation","shows","bands"])),data:function(){return{user_id:11111,distance_max:.013,distance:null,show_closest:null,band_closest:null,shows_close:[],shows_far:[],showFar_closest:null,show_founded:!1,shows_active:[],clapp_time:0,clapp_taps:0,clapp_start:null,clapps:0,clapp_animacion:["tap to clapp","beh","guay","la ostia","wooooooooow"],clapp_step:0,clapp_step_init:0,interval:null,upload_timer:null,findLocation:!1}},watch:{clapp_time:function(){console.log(this.clapp_time);var o=Math.round(this.clapp_time/100);o<1?this.clapp_taps++:this.clapps+=o},clapp_taps:function(){this.clapps++},geolocation:function(){this.filter_shows_today(),this.arrangeShows()},clapps:function(){this.clapps>10?this.clapps>20?this.clapp_step_init=2:this.clapp_step_init=1:this.clapp_step_init=0},shows:function(){this.filter_shows_today(),this.arrangeShows()}},created:function(){this.geolocation&&this.shows&&(this.filter_shows_today(),this.arrangeShows())},mounted:function(){},methods:{filter_shows_today:function(){var o=this;console.log("filtering");var t=this.$moment();this.shows.forEach((function(e){var n=o.$moment(e.timestamp),s=n.diff(t,"hours");s>-1&&s<1&&o.shows_active.push(e)}))},arrangeShows:function(){var o=this;console.log("arranging shows"),this.shows_active.forEach((function(t){t.position={lat:t.lat,lon:t.lon},o.isCerca(t.position,o.geolocation)?(o.show_founded=!0,t.distance=o.distance,o.shows_close.push(t)):(t.distance=o.distance,o.shows_far.push(t))})),this.shows_close.sort((function(o,t){return o.distance-t.distance})),this.shows_far.sort((function(o,t){return o.distance-t.distance})),this.show_closest=this.shows_close[0],this.showFar_closest=this.shows_far[0],this.show_closest&&(this.band_closest=this.getBand(this.show_closest.band_id))},isCerca:function(o,t){return this.distance=Math.pow(Math.pow(o.lat-t.lat,2)+Math.pow(o.lon-t.lon,2),.5),this.distance<=this.distance_max},getBand:function(o){return console.log("get band"),this.bands.find((function(t){return t.id===o}))},touchHandler:function(o){console.log("touch")},startHandler:function(o){var t=this;clearInterval(this.upload_timer),this.clapp_step=this.clapp_step_init,this.interval=setInterval((function(){t.clapp_step<3&&t.clapp_step++}),500);var e=this.$moment(o.timeStamp).millisecond();console.log("start: "+e),this.clapp_start=e},endHandler:function(o){var t=this;clearInterval(this.interval),setTimeout((function(){t.clapp_step=0}),1e3);var e=this.$moment(o.timeStamp);console.log("end:"+e.millisecond()),this.clapp_time=e.subtract(this.clapp_start,"milliseconds").millisecond(),this.upload_timer=setTimeout((function(){t.uploadClapps()}),3e3)},longtapHandler:function(o){console.log(o)},uploadClapps:function(){var o=this,t=this.user_id+"-"+this.show_closest.band_id+"-"+this.clapps,e={band_id:this.band_closest.id,show_id:this.show_closest.show_id,user_id:this.user_id,clapp_time:this.clapp_time,clapp_taps:this.clapp_taps,timestamp:new Date};l.a.firestore().collection("clapps").doc(t).set(e).then((function(){console.log("clapp uploaded"),o.postclapp("band_profile")}))},postclapp:function(o){"band_profile"===o&&this.$router.push({name:"sub",params:{from:"postclapp",sub_page:"sub_profile_band",id:this.band_closest.id}})},geolocationError:function(o){alert(o)}}},b=w,v=(e("d059"),Object(d["a"])(b,n,s,!1,null,"451b3c58",null));t["default"]=v.exports},cd1c:function(o,t,e){var n=e("e853");o.exports=function(o,t){return new(n(o))(t)}},d059:function(o,t,e){"use strict";var n=e("f6d0"),s=e.n(n);s.a},e853:function(o,t,e){var n=e("d3f4"),s=e("1169"),a=e("2b4c")("species");o.exports=function(o){var t;return s(o)&&(t=o.constructor,"function"!=typeof t||t!==Array&&!s(t.prototype)||(t=void 0),n(t)&&(t=t[a],null===t&&(t=void 0))),void 0===t?Array:t}},f6d0:function(o,t,e){}}]);
//# sourceMappingURL=chunk-57d2a4b8.9c7b8789.js.map