{"remainingRequest":"/Users/robertomesejosalas/websites/dclappmusic.github.io/_prototipo-dev/node_modules/babel-loader/lib/index.js!/Users/robertomesejosalas/websites/dclappmusic.github.io/_prototipo-dev/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/robertomesejosalas/websites/dclappmusic.github.io/_prototipo-dev/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/robertomesejosalas/websites/dclappmusic.github.io/_prototipo-dev/src/App.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/robertomesejosalas/websites/dclappmusic.github.io/_prototipo-dev/src/App.vue","mtime":1574596403000},{"path":"/Users/robertomesejosalas/websites/dclappmusic.github.io/_prototipo-dev/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/robertomesejosalas/websites/dclappmusic.github.io/_prototipo-dev/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/robertomesejosalas/websites/dclappmusic.github.io/_prototipo-dev/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/robertomesejosalas/websites/dclappmusic.github.io/_prototipo-dev/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport firebase from \"firebase\";\nimport Nav from '@/components/Nav';\nimport PopupInstall from '@/components/PopupInstall';\nimport PopupLogin from '@/components/PopupLogin';\nexport default {\n  name: 'app',\n  components: {\n    Nav: Nav,\n    PopupInstall: PopupInstall,\n    PopupLogin: PopupLogin\n  },\n  data: function data() {\n    return {\n      show_login: true,\n      usuario: {},\n      geolocation: {\n        latitud: null,\n        longitud: null\n      },\n      shows: [],\n      show_install: false,\n      deferredPrompt: null\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    setInterval(function () {\n      _this.fecha_hoy = new Date();\n    }, 1000);\n    firebase.auth().onAuthStateChanged(function (user) {\n      if (user) {\n        console.log(\"ya estas logueado\");\n        console.log(user);\n        _this.show_login = false; //descargarse usuario\n\n        firebase.firestore().collection(\"fans\").doc(user.uid).onSnapshot(function (doc) {\n          _this.usuario = doc.data();\n          console.log(_this.usuario);\n        }); // this.$router.replace('fichaje');\n      } else {\n        // No user is signed in.\n        _this.show_login = true;\n        console.log(\"no estás logueado\");\n      }\n    });\n  },\n  mounted: function mounted() {\n    var _this2 = this;\n\n    this.get_shows(); // alert(\"mounted\");\n\n    window.addEventListener('beforeinstallprompt', function (e) {\n      // Prevent Chrome 67 and earlier from automatically showing the prompt\n      e.preventDefault(); // alert(\"before install\");\n      // Stash the event so it can be triggered later.\n\n      _this2.deferredPrompt = e; // Update UI notify the user they can add to home screen\n\n      _this2.show_install = true;\n    });\n  },\n  methods: {\n    get_shows: function get_shows() {\n      var _this3 = this;\n\n      if (localStorage.getItem('coords')) {\n        this.geolocation = JSON.parse(localStorage.getItem('coords'));\n        console.log(this.geolocation);\n      }\n\n      this.get_geolocation();\n      var db = firebase.firestore();\n      db.collection(\"shows\").onSnapshot(function (querySnapshot) {\n        querySnapshot.forEach(function (doc) {\n          var shows = doc.data();\n          console.log(shows);\n\n          _this3.shows.push(shows);\n        });\n      });\n    },\n    event_cerrar_popup: function event_cerrar_popup(deferredPrompt) {\n      this.show_install = false;\n      this.deferredPrompt = deferredPrompt;\n    },\n    get_geolocation: function get_geolocation() {\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(this.browserGeolocationSuccess, this.browserGeolocationFail, {\n          maximumAge: 20000,\n          timeout: 10000,\n          enableHighAccuracy: false\n        });\n      } else {\n        console.log(\"Navigator geolocation unavailable.\"); // $(\".act .name\").html(\"No se puede acceder a la ubicación en tu móvil :'(\").addClass(\"error\");\n      }\n    },\n    browserGeolocationSuccess: function browserGeolocationSuccess(position) {\n      this.geolocation.latitud = position.coords.latitude;\n      this.geolocation.longitud = position.coords.longitude;\n      console.log(\"Browser geolocation success!\\n\\nlat = \" + position.coords.latitude + \"\\nlng = \" + position.coords.longitude);\n      localStorage.setItem('coords', JSON.stringify(this.geolocation));\n    },\n    browserGeolocationFail: function browserGeolocationFail(error) {\n      switch (error.code) {\n        case error.TIMEOUT:\n          console.log(\"Browser geolocation error !\\n\\nTimeout.\"); // $(\".act .name\").html(\"Hay problemas con el acceso a tu ubicación\");\n\n          break;\n\n        case error.PERMISSION_DENIED:\n          if (error.message.indexOf(\"Only secure origins are allowed\") == 0) {\n            this.tryAPIGeolocation();\n          } else {\n            console.log(\"Permison denied\"); // $(\".act .name\").html(\"No nos has dado permiso de acceder a tu ubicación\");\n            // $(\".intro_clapp h3\").html(\"No nos has dado permiso de acceder a tu ubicación\");\n          }\n\n          break;\n\n        case error.POSITION_UNAVAILABLE:\n          console.log(\"Browser geolocation error !\\n\\nPosition unavailable.\"); // $(\".act .name\").html(\"Browser geolocation error !\\n\\nPosition unavailable\");\n\n          break;\n      }\n    },\n    tryAPIGeolocation: function tryAPIGeolocation() {\n      jQuery.post(\"https://www.googleapis.com/geolocation/v1/geolocate?key=AIzaSyDCa1LUe1vOczX1hO_iGYgyo8p_jYuGOPU\", function (success) {\n        this.apiGeolocationSuccess({\n          coords: {\n            latitude: success.location.lat,\n            longitude: success.location.lng\n          }\n        });\n      }).fail(function (err) {\n        console.log(\"API Geolocation error! \\n\\n\" + err); // $(\".act .name\").html(\"API Geolocation error! \\n\\n\"+err);\n      });\n    },\n    apiGeolocationSuccess: function apiGeolocationSuccess(position) {\n      this.geolocation.latitud = position.coords.latitude;\n      this.geolocation.longitud = position.coords.longitude;\n      console.log(\"API geolocation success!\\n\\nlat = \" + latitud + \"\\nlng = \" + longitud);\n      localStorage.setItem('coords', JSON.stringify(this.geolocation));\n    }\n  }\n};",{"version":3,"sources":["App.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n\t<div id=\"app\" class=\"container\">\n\t\t<router-view\n            :geolocation=\"this.geolocation\"\n            :shows=\"this.shows\"\n            :usuario=\"usuario\"\n\t\t/>\n        <PopupLogin v-if=\"show_login\" />\n\t\t<PopupInstall \n\t\t\tv-if=\"show_install\" \n\t\t\t:deferredPrompt=\"this.deferredPrompt\" \n\t\t\t@cerrar_popup=\"event_cerrar_popup\"\n\t\t/>\n\t</div>\n</template>\n\n<script>\n\timport firebase from \"firebase\";\n\timport Nav from '@/components/Nav';\n\timport PopupInstall from '@/components/PopupInstall';\n    import PopupLogin from '@/components/PopupLogin';\n\n\texport default {\n\t\tname: 'app',\n\t\tcomponents: {\n\t\t\tNav,\n\t\t\tPopupInstall,\n            PopupLogin\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n                show_login: true,\n                usuario: {},\n                geolocation: {\n                    latitud: null,\n                    longitud: null\n                },\n                shows: [],\n                show_install: false,\n                deferredPrompt: null\n\t\t\t}\n\t\t},\n\t\tcreated() {\n            setInterval(() => {\n                this.fecha_hoy = new Date();\n            }, 1000);\n\n\t\t\tfirebase.auth().onAuthStateChanged(user => {\n\t\t\t\tif (user) {\n\t\t\t\t\tconsole.log(\"ya estas logueado\");\n\t\t\t\t\tconsole.log(user);\n\t\t\t\t\tthis.show_login = false;\n//descargarse usuario\n\t\t\t\t\tfirebase.firestore().collection(\"fans\").doc(user.uid).onSnapshot((doc) => {\n                        this.usuario = doc.data();\n                        console.log(this.usuario);\n\t\t\t\t\t});\n\t\t\t\t\t// this.$router.replace('fichaje');\n\t\t\t\t} else {\n\t\t\t\t\t// No user is signed in.\n                    this.show_login = true;\n\t\t\t\t\tconsole.log(\"no estás logueado\");\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tmounted() {\n            this.get_shows();\n\t\t\t// alert(\"mounted\");\n\t\t\twindow.addEventListener('beforeinstallprompt', (e) => {\n\t\t\t\t// Prevent Chrome 67 and earlier from automatically showing the prompt\n\t\t\t\te.preventDefault();\n\t\t\t\t// alert(\"before install\");\n\t\t\t\t// Stash the event so it can be triggered later.\n\t\t\t\tthis.deferredPrompt = e;\n\t\t\t\t\n\t\t\t\t// Update UI notify the user they can add to home screen\n\t\t\t\tthis.show_install = true;\n\t\t\t});\n\t\t},\n\t\tmethods: {\n            get_shows: function() {\n                if (localStorage.getItem('coords')){\n                    this.geolocation = JSON.parse(localStorage.getItem('coords'));\n                    console.log(this.geolocation);\n                }\n                this.get_geolocation();\n                var db = firebase.firestore();\n                db.collection(\"shows\").onSnapshot((querySnapshot) => {\n                    querySnapshot.forEach((doc) => {\n                        var shows = doc.data();\n                        console.log(shows);\n                        this.shows.push(shows);\n                    });\n                });\n            },\n            event_cerrar_popup: function(deferredPrompt) {\n\t\t\t\tthis.show_install = false;\n\t\t\t\tthis.deferredPrompt = deferredPrompt;\n\t\t\t},\n\t\t\tget_geolocation: function() {\n                if (navigator.geolocation) {\n                    navigator.geolocation.getCurrentPosition(\n                        this.browserGeolocationSuccess,\n                        this.browserGeolocationFail,\n                        {maximumAge: 20000, timeout: 10000, enableHighAccuracy: false}\n                    );\n                } else {\n                    console.log(\"Navigator geolocation unavailable.\");\n                    // $(\".act .name\").html(\"No se puede acceder a la ubicación en tu móvil :'(\").addClass(\"error\");\n                }\n            },\n            browserGeolocationSuccess: function(position) {\n                this.geolocation.latitud = position.coords.latitude;\n                this.geolocation.longitud = position.coords.longitude;\n                console.log(\"Browser geolocation success!\\n\\nlat = \" + position.coords.latitude + \"\\nlng = \" + position.coords.longitude);\n                localStorage.setItem('coords', JSON.stringify(this.geolocation));\n            },\n            browserGeolocationFail: function(error) {\n                switch (error.code) {\n                    case error.TIMEOUT:\n                        console.log(\"Browser geolocation error !\\n\\nTimeout.\");\n                        // $(\".act .name\").html(\"Hay problemas con el acceso a tu ubicación\");\n                    break;\n                    case error.PERMISSION_DENIED:\n                        if(error.message.indexOf(\"Only secure origins are allowed\") == 0) {\n                            this.tryAPIGeolocation();\n                        } else {\n                            console.log(\"Permison denied\");\n                            // $(\".act .name\").html(\"No nos has dado permiso de acceder a tu ubicación\");\n                            // $(\".intro_clapp h3\").html(\"No nos has dado permiso de acceder a tu ubicación\");\n                        }\n                    break;\n                    case error.POSITION_UNAVAILABLE:\n                        console.log(\"Browser geolocation error !\\n\\nPosition unavailable.\");\n                        // $(\".act .name\").html(\"Browser geolocation error !\\n\\nPosition unavailable\");\n                    break;\n                }\n            },\n            tryAPIGeolocation: function() {\n                jQuery.post( \"https://www.googleapis.com/geolocation/v1/geolocate?key=AIzaSyDCa1LUe1vOczX1hO_iGYgyo8p_jYuGOPU\", function(success) {\n                    this.apiGeolocationSuccess({coords: {latitude: success.location.lat, longitude: success.location.lng}});\n                })\n                .fail(function(err) {\n                    console.log(\"API Geolocation error! \\n\\n\"+err);\n                    // $(\".act .name\").html(\"API Geolocation error! \\n\\n\"+err);\n                });\n            },\n\n            apiGeolocationSuccess: function(position) {\n                this.geolocation.latitud = position.coords.latitude;\n                this.geolocation.longitud = position.coords.longitude;\n                console.log(\"API geolocation success!\\n\\nlat = \" + latitud + \"\\nlng = \" + longitud);\n                localStorage.setItem('coords', JSON.stringify(this.geolocation));\n            }\n\t\t}\n\t};\n</script>"],"sourceRoot":"src"}]}